{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport fetch from \"cross-fetch\";\nimport initialStateBlock from \"./initialState\";\nexport const checkBlockStatus = createAsyncThunk(\"blocks/checkBlockStatus\", async node => {\n  const response = await fetch(`${node.url}/api/v1/blocks`);\n  const {\n    data\n  } = await response.json();\n  return {\n    data,\n    url: node.url\n  };\n});\nexport const checkBlocksStatus = createAsyncThunk(\"block/checkBlocksStatus\", async (nodes, thunkAPI) => {\n  const {\n    dispatch\n  } = thunkAPI;\n\n  for (const node of nodes) {\n    if (node.online) {\n      dispatch(checkBlockStatus(node));\n    }\n  }\n});\nexport const blockSlice = createSlice({\n  name: \"blocks\",\n  initialState: initialStateBlock(),\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(checkBlockStatus.pending, (state, action) => {\n      state.push({\n        isError: false,\n        isLoading: true,\n        data: []\n      });\n    });\n    builder.addCase(checkBlockStatus.fulfilled, (state, action) => {\n      state.push(action.payload);\n    });\n    builder.addCase(checkBlockStatus.rejected, (state, action) => {\n      state.push({\n        isError: true,\n        isLoading: false,\n        data: []\n      });\n    });\n  }\n});\nexport const selectBlocks = state => state;\nexport default blockSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","fetch","initialStateBlock","checkBlockStatus","node","response","url","data","json","checkBlocksStatus","nodes","thunkAPI","dispatch","online","blockSlice","name","initialState","reducers","extraReducers","builder","addCase","pending","state","action","push","isError","isLoading","fulfilled","payload","rejected","selectBlocks","reducer"],"sources":["/Users/marvin/Desktop/fullstacklabs/challenge/toy-blocks-client-react/src/reducers/blocks/blocks.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport initialState from \"./initialState\";\nimport { Node } from \"../../types/Node\";\nimport { ShapeBlock } from \"../../types/Blocks\";\nimport { RootState } from \"../../store/configureStore\";\nimport fetch from \"cross-fetch\";\nimport initialStateBlock from \"./initialState\";\n\n\nexport const checkBlockStatus = createAsyncThunk(\n  \"blocks/checkBlockStatus\",\n  async (node: Node) => {\n    const response = await fetch(`${node.url}/api/v1/blocks`);\n    const { data } = await response.json();\n    return { data, url: node.url };\n  }\n);\n\nexport const checkBlocksStatus = createAsyncThunk(\n  \"block/checkBlocksStatus\",\n  async (nodes: Node[], thunkAPI) => {\n    const { dispatch } = thunkAPI;\n    for (const node of nodes) {\n      if (node.online) {\n        dispatch(checkBlockStatus(node));\n      }\n    }\n  }\n);\n\nexport const blockSlice = createSlice({\n  name: \"blocks\",\n  initialState: initialStateBlock() as ShapeBlock[],\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(checkBlockStatus.pending, (state, action) => {\n     state.push({ isError: false, isLoading: true, data: [] });\n    });\n    builder.addCase(checkBlockStatus.fulfilled, (state, action) => {\n      state.push(action.payload);\n    });\n    builder.addCase(checkBlockStatus.rejected, (state, action) => {\n      state.push({ isError: true, isLoading: false, data: [] });\n    });\n  },\n});\n\nexport const selectBlocks = (state: RootState) => state;\n\nexport default blockSlice.reducer;\n"],"mappings":"AAAA,SAASA,gBAAT,EAA2BC,WAA3B,QAA8C,kBAA9C;AAKA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,iBAAP,MAA8B,gBAA9B;AAGA,OAAO,MAAMC,gBAAgB,GAAGJ,gBAAgB,CAC9C,yBAD8C,EAE9C,MAAOK,IAAP,IAAsB;EACpB,MAAMC,QAAQ,GAAG,MAAMJ,KAAK,CAAE,GAAEG,IAAI,CAACE,GAAI,gBAAb,CAA5B;EACA,MAAM;IAAEC;EAAF,IAAW,MAAMF,QAAQ,CAACG,IAAT,EAAvB;EACA,OAAO;IAAED,IAAF;IAAQD,GAAG,EAAEF,IAAI,CAACE;EAAlB,CAAP;AACD,CAN6C,CAAzC;AASP,OAAO,MAAMG,iBAAiB,GAAGV,gBAAgB,CAC/C,yBAD+C,EAE/C,OAAOW,KAAP,EAAsBC,QAAtB,KAAmC;EACjC,MAAM;IAAEC;EAAF,IAAeD,QAArB;;EACA,KAAK,MAAMP,IAAX,IAAmBM,KAAnB,EAA0B;IACxB,IAAIN,IAAI,CAACS,MAAT,EAAiB;MACfD,QAAQ,CAACT,gBAAgB,CAACC,IAAD,CAAjB,CAAR;IACD;EACF;AACF,CAT8C,CAA1C;AAYP,OAAO,MAAMU,UAAU,GAAGd,WAAW,CAAC;EACpCe,IAAI,EAAE,QAD8B;EAEpCC,YAAY,EAAEd,iBAAiB,EAFK;EAGpCe,QAAQ,EAAE,EAH0B;EAIpCC,aAAa,EAAGC,OAAD,IAAa;IAC1BA,OAAO,CAACC,OAAR,CAAgBjB,gBAAgB,CAACkB,OAAjC,EAA0C,CAACC,KAAD,EAAQC,MAAR,KAAmB;MAC5DD,KAAK,CAACE,IAAN,CAAW;QAAEC,OAAO,EAAE,KAAX;QAAkBC,SAAS,EAAE,IAA7B;QAAmCnB,IAAI,EAAE;MAAzC,CAAX;IACA,CAFD;IAGAY,OAAO,CAACC,OAAR,CAAgBjB,gBAAgB,CAACwB,SAAjC,EAA4C,CAACL,KAAD,EAAQC,MAAR,KAAmB;MAC7DD,KAAK,CAACE,IAAN,CAAWD,MAAM,CAACK,OAAlB;IACD,CAFD;IAGAT,OAAO,CAACC,OAAR,CAAgBjB,gBAAgB,CAAC0B,QAAjC,EAA2C,CAACP,KAAD,EAAQC,MAAR,KAAmB;MAC5DD,KAAK,CAACE,IAAN,CAAW;QAAEC,OAAO,EAAE,IAAX;QAAiBC,SAAS,EAAE,KAA5B;QAAmCnB,IAAI,EAAE;MAAzC,CAAX;IACD,CAFD;EAGD;AAdmC,CAAD,CAA9B;AAiBP,OAAO,MAAMuB,YAAY,GAAIR,KAAD,IAAsBA,KAA3C;AAEP,eAAeR,UAAU,CAACiB,OAA1B"},"metadata":{},"sourceType":"module"}